<div class="site-container">
  <div id="form-paper">
    <div ng-app="app">
      <div ng-controller="rfpsIndexCtrl" ng-init="setup()">
        <div class="form-heading">

          <h1> RFP Submission Review </h1>
          <% if current_user.admin %>
            <% if current_user.rfp_ratings.find_by(rfp_id: @rfp.id) != nil %>
              <div id="rating-pullout-button">
                <button type="button" class="btn btn-danger" data-toggle="collapse" aria-expanded="false" aria-controls="rfp-ratings" data-target="#rfp-ratings">Edit Rating</button>
              </div>
            <% end %>
          <div class="form-body">

            <ol class="form-list">
              <!-- REPEAT SECTIONS -->
              <div ng-repeat= "section in sections track by $index" >

                <div>
                  <h1> {{section.rfp_section}} </h1>

                  <!-- REPEAT RFP-QUESTIONS -->
                  <table class="table table-striped table-bordered" >


                    <tr ng-repeat="question in section.rfp_questions" ng-if="question.rfp_answer != 'See Subs'">

                      <td class="td-question">
                        <b>
                          {{question.rfp_question}}:
                        </b>
                      </td> 

                      <td class="td-answer" ng-if="question.rfp_answer != null">
                        {{question.rfp_answer}}
                      </td>

                      <td ng-if="question.rfp_answer == null">
                        <table class="table table-striped table-bordered">

                          <!-- REPEAT MULTIPLE INPUTS -->
                          <tr ng-repeat="answer in question.rfp_answers">
                            <td class="td-answer">
                              {{answer.rfp_answer}}
                            </td>
                          </tr>
                          <!-- END REPEAT MULTIPLE INPUTS -->

                        </table>
                      </td>

                    </tr>

                    <!-- REPEAT SUB-QUESTIONS -->
                    <tr ng-repeat="question in section.rfp_questions" ng-if="question.rfp_answer == 'See Subs'">
                      <td class="td-question">
                        <b>
                          {{question.rfp_question}}:
                        </b>
                      </td>

                      <td>
                        <table class="table table-striped table-bordered" >

                          <tr ng-repeat="sub_question in question.sub_questions">
                            <td class="td-question">
                              <b>
                                {{sub_question.sub_question}}: 
                              </b>
                            </td>

                            <td class="td-answer">
                              {{sub_question.sub_answer}}
                            </td>
                          </tr>

                        </table>
                      </td>
                    </tr>
                    <!-- END REPEAT SUB-QUESTIONS -->


                  </table>
                  <!-- END REPEAT RFP-QUESTIONS -->
                </div>
              </div>
              <!-- END REPEAT SECTIONS -->
              <ol>
              </div>
            </div>
          <% end %>
          </div>
        </div>
      </div>
    </div> 